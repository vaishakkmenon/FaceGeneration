[INFO] Launching Training
[INFO] Process group initialized for rank 3
[INFO] Process group initialized for rank 2
[INFO] Process group initialized for rank 1
/workspace/GAN-Models/gan_env/lib/python3.10/site-packages/torch/cuda/__init__.py:235: UserWarning: 
NVIDIA GeForce RTX 5090 with CUDA capability sm_120 is not compatible with the current PyTorch installation.
The current PyTorch install supports CUDA capabilities sm_50 sm_60 sm_70 sm_75 sm_80 sm_86 sm_90.
If you want to use the NVIDIA GeForce RTX 5090 GPU with PyTorch, please check the instructions at https://pytorch.org/get-started/locally/

  warnings.warn(
[INFO] Process group initialized for rank 0
/workspace/GAN-Models/gan_env/lib/python3.10/site-packages/torch/cuda/__init__.py:235: UserWarning: 
NVIDIA GeForce RTX 5090 with CUDA capability sm_120 is not compatible with the current PyTorch installation.
The current PyTorch install supports CUDA capabilities sm_50 sm_60 sm_70 sm_75 sm_80 sm_86 sm_90.
If you want to use the NVIDIA GeForce RTX 5090 GPU with PyTorch, please check the instructions at https://pytorch.org/get-started/locally/

  warnings.warn(
/workspace/GAN-Models/gan_env/lib/python3.10/site-packages/torch/cuda/__init__.py:235: UserWarning: 
NVIDIA GeForce RTX 5090 with CUDA capability sm_120 is not compatible with the current PyTorch installation.
The current PyTorch install supports CUDA capabilities sm_50 sm_60 sm_70 sm_75 sm_80 sm_86 sm_90.
If you want to use the NVIDIA GeForce RTX 5090 GPU with PyTorch, please check the instructions at https://pytorch.org/get-started/locally/

  warnings.warn(
/workspace/GAN-Models/gan_env/lib/python3.10/site-packages/torch/cuda/__init__.py:235: UserWarning: 
NVIDIA GeForce RTX 5090 with CUDA capability sm_120 is not compatible with the current PyTorch installation.
The current PyTorch install supports CUDA capabilities sm_50 sm_60 sm_70 sm_75 sm_80 sm_86 sm_90.
If you want to use the NVIDIA GeForce RTX 5090 GPU with PyTorch, please check the instructions at https://pytorch.org/get-started/locally/

  warnings.warn(
[INFO] Initialized process group and set device for rank 0
cuda:0
[INFO] Resolved dataset path: /workspace/GAN-Models/data/mnist/
[INFO] Initialized process group and set device for rank 3
cuda:3
[INFO] Resolved dataset path: /workspace/GAN-Models/data/mnist/
[INFO] Returning Full Dataset for DDP
[INFO] Dataset loaded and DataLoader created on rank 0
[INFO] Moving models to device and wrapping with DDP on rank 0
[DEBUG] Initializing Generator and Discriminator models on rank 0
[INFO] Returning Full Dataset for DDP
[INFO] Dataset loaded and DataLoader created on rank 3
[INFO] Moving models to device and wrapping with DDP on rank 3
[DEBUG] Initializing Generator and Discriminator models on rank 3
[INFO] Initialized process group and set device for rank 1
cuda:1
[INFO] Resolved dataset path: /workspace/GAN-Models/data/mnist/
[DEBUG] Models initialized on rank 3
[INFO] Initialized process group and set device for rank 2
cuda:2
[INFO] Resolved dataset path: /workspace/GAN-Models/data/mnist/
[INFO] Returning Full Dataset for DDP
[INFO] Dataset loaded and DataLoader created on rank 1
[INFO] Moving models to device and wrapping with DDP on rank 1
[DEBUG] Initializing Generator and Discriminator models on rank 1
[DEBUG] Models initialized on rank 1
[INFO] Returning Full Dataset for DDP
[INFO] Dataset loaded and DataLoader created on rank 2
[INFO] Moving models to device and wrapping with DDP on rank 2
[DEBUG] Initializing Generator and Discriminator models on rank 2
[DEBUG] Models initialized on rank 2
[DEBUG] Models initialized on rank 0
4b958fe9d2bf:5322:5322 [0] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
4b958fe9d2bf:5322:5322 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
4b958fe9d2bf:5322:5322 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
4b958fe9d2bf:5322:5322 [0] NCCL INFO NET/Plugin: Using internal network plugin.
4b958fe9d2bf:5322:5322 [0] NCCL INFO cudaDriverVersion 12080
NCCL version 2.21.5+cuda12.4
4b958fe9d2bf:5322:5322 [0] NCCL INFO init.cc:1785 Cuda Host Alloc Size 4 pointer 0x79baed200000
4b958fe9d2bf:5322:5322 [0] NCCL INFO Comm config Blocking set to 1
4b958fe9d2bf:5323:5323 [1] NCCL INFO cudaDriverVersion 12080
4b958fe9d2bf:5323:5323 [1] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
4b958fe9d2bf:5323:5323 [1] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
4b958fe9d2bf:5323:5323 [1] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
4b958fe9d2bf:5323:5323 [1] NCCL INFO NET/Plugin: Using internal network plugin.
4b958fe9d2bf:5325:5325 [3] NCCL INFO cudaDriverVersion 12080
4b958fe9d2bf:5325:5325 [3] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
4b958fe9d2bf:5325:5325 [3] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
4b958fe9d2bf:5325:5325 [3] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
4b958fe9d2bf:5325:5325 [3] NCCL INFO NET/Plugin: Using internal network plugin.
4b958fe9d2bf:5324:5324 [2] NCCL INFO cudaDriverVersion 12080
4b958fe9d2bf:5324:5324 [2] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
4b958fe9d2bf:5324:5324 [2] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
4b958fe9d2bf:5324:5324 [2] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
4b958fe9d2bf:5324:5324 [2] NCCL INFO NET/Plugin: Using internal network plugin.
4b958fe9d2bf:5323:5323 [1] NCCL INFO init.cc:1785 Cuda Host Alloc Size 4 pointer 0x7e3865200000
4b958fe9d2bf:5323:5323 [1] NCCL INFO Comm config Blocking set to 1
4b958fe9d2bf:5324:5324 [2] NCCL INFO init.cc:1785 Cuda Host Alloc Size 4 pointer 0x7ba245200000
4b958fe9d2bf:5324:5324 [2] NCCL INFO Comm config Blocking set to 1
4b958fe9d2bf:5325:5325 [3] NCCL INFO init.cc:1785 Cuda Host Alloc Size 4 pointer 0x7bee41200000
4b958fe9d2bf:5325:5325 [3] NCCL INFO Comm config Blocking set to 1

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5322:5788 [0] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'
4b958fe9d2bf:5322:5788 [0] NCCL INFO init.cc:1516 -> 1
4b958fe9d2bf:5322:5788 [0] NCCL INFO group.cc:64 -> 1 [Async thread]
4b958fe9d2bf:5322:5322 [0] NCCL INFO group.cc:418 -> 1
4b958fe9d2bf:5322:5322 [0] NCCL INFO init.cc:1929 -> 1

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5325:5791 [3] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'
4b958fe9d2bf:5325:5791 [3] NCCL INFO init.cc:1516 -> 1
4b958fe9d2bf:5325:5791 [3] NCCL INFO group.cc:64 -> 1 [Async thread]
4b958fe9d2bf:5325:5325 [3] NCCL INFO group.cc:418 -> 1
4b958fe9d2bf:5325:5325 [3] NCCL INFO init.cc:1929 -> 1

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5323:5789 [1] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'
4b958fe9d2bf:5323:5789 [1] NCCL INFO init.cc:1516 -> 1
4b958fe9d2bf:5323:5789 [1] NCCL INFO group.cc:64 -> 1 [Async thread]
4b958fe9d2bf:5323:5323 [1] NCCL INFO group.cc:418 -> 1
4b958fe9d2bf:5323:5323 [1] NCCL INFO init.cc:1929 -> 1

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'

4b958fe9d2bf:5324:5790 [2] enqueue.cc:60 NCCL WARN Cuda failure 'invalid argument'
4b958fe9d2bf:5324:5790 [2] NCCL INFO init.cc:1516 -> 1
4b958fe9d2bf:5324:5790 [2] NCCL INFO group.cc:64 -> 1 [Async thread]
4b958fe9d2bf:5324:5324 [2] NCCL INFO group.cc:418 -> 1
4b958fe9d2bf:5324:5324 [2] NCCL INFO init.cc:1929 -> 1
[rank0]:[W403 18:24:51.913409568 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
W0403 18:24:52.681000 5256 torch/multiprocessing/spawn.py:169] Terminating process 5322 via signal SIGTERM
W0403 18:24:52.682000 5256 torch/multiprocessing/spawn.py:169] Terminating process 5323 via signal SIGTERM
W0403 18:24:52.682000 5256 torch/multiprocessing/spawn.py:169] Terminating process 5324 via signal SIGTERM
Traceback (most recent call last):
  File "/workspace/GAN-Models/model/GAN/full_script.py", line 281, in <module>
    mp.spawn(train, args=(world_size,), nprocs=world_size, join=True)
  File "/workspace/GAN-Models/gan_env/lib/python3.10/site-packages/torch/multiprocessing/spawn.py", line 340, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
  File "/workspace/GAN-Models/gan_env/lib/python3.10/site-packages/torch/multiprocessing/spawn.py", line 296, in start_processes
    while not context.join():
  File "/workspace/GAN-Models/gan_env/lib/python3.10/site-packages/torch/multiprocessing/spawn.py", line 215, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 3 terminated with the following error:
Traceback (most recent call last):
  File "/workspace/GAN-Models/gan_env/lib/python3.10/site-packages/torch/multiprocessing/spawn.py", line 90, in _wrap
    fn(i, *args)
  File "/workspace/GAN-Models/model/GAN/full_script.py", line 177, in train
    G = DDP(G, device_ids=[rank])
  File "/workspace/GAN-Models/gan_env/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 825, in __init__
    _verify_param_shape_across_processes(self.process_group, parameters)
  File "/workspace/GAN-Models/gan_env/lib/python3.10/site-packages/torch/distributed/utils.py", line 294, in _verify_param_shape_across_processes
    return dist._verify_params_across_processes(process_group, tensors, logger)
torch.distributed.DistBackendError: NCCL error in: /pytorch/torch/csrc/distributed/c10d/NCCLUtils.hpp:268, unhandled cuda error (run with NCCL_DEBUG=INFO for details), NCCL version 2.21.5
ncclUnhandledCudaError: Call to CUDA function failed.
Last error:
Cuda failure 'invalid argument'

